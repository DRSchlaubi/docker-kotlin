on:
  push:
#  schedule:
#    - cron: "0 * * * *"

jobs:
  run:
    name: "Check for new Kotlin releases"
    runs-on: ubuntu-20.04
    steps:
      - uses: actions/checkout@v2
        with:
          ref: "main"
      - name: Setup Java JDK 1.6
        uses: actions/setup-java@v2.1.0
        with:
          distribution: 'adopt'
          java-version: 16
      - name: Gradle (RUN)
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: cd tools && gradle --stacktrace --info --build-cache :release_notifier:run
      - name: Update Previous file
        run: "git diff --exit-code --quiet -- notify_kotlin_releases/previous.json || (git add notify_kotlin_releases/previous.json && git commit -m \":pushpin: Update Kotlin previous releases\" && git push origin HEAD)"
